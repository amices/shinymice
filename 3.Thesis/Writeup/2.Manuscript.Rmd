---
title: "Missing the Point: Non-Convergence in Iterative Imputation Algorithms"
runninghead: Oberman
author:
  name: H. I. Oberman
  num: 1
address:
  num: 1
  org: Department of Methodology and Statistics, Utrecht University, Utrecht, The Netherlands.
corrauth: "Hanne Oberman, Sjoerd Groenman building, Padualaan 14, 3584 CH, Utrecht, The Netherlands."
email: h.i.oberman@uu.nl
abstract: "Iterative imputation is a popular tool to accommodate missing data. While it is widely accepted that valid inferences can be obtained with this technique, these inferences all rely on algorithmic convergence. There is no consensus on how to evaluate the convergence properties of the method. This paper provides insight into identifying non-convergence in iterative imputation algorithms. Our study found that---in the cases considered---inferential validity was achieved after five to ten iterations, much earlier than indicated by the $\\widehat{R}$ and $AC$ diagnostics. We conclude that it never hurts to iterate longer, but such calculations hardly bring added value."
keywords: missing data, iterative imputation, non-convergence, MICE
classoption:
 - Royal
 - times
bibliography: thesis.bib
bibliographystyle: sageh
output:
  bookdown::pdf_book:
    base_format: rticles::sage_article
    keep_tex: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width = 4.9, echo = FALSE, fig.align = "center") 
# knitr::opts_chunk$set(fig.width = 4.8, fig.height = 3.6, echo = FALSE, fig.align = "center") 

# packages
library(mice)
library(dplyr)
library(ggplot2)
library(patchwork)

# load example non-convergence and figures
load("../Results/example_nonconv.Rdata")
load("../Results/example_conv.Rdata")
load("../Results/example_diagnostics.Rdata")
source("../3.PlotExampleNon-convergence.R")

# load results and figures
load("../Results/complete.Rdata") 
results <- results %>% filter(t<51)
source("../4.PlotResults.R")

# default graphing behavior
theme_update(
 plot.title = element_text(hjust = 0.5),
 plot.subtitle = element_text(hjust = 0.5),
 panel.border = element_blank(),
 panel.grid.major = element_blank(),
 panel.grid.minor = element_blank(),
 panel.background = element_blank(),
 axis.line = element_line(colour = "black"),
 legend.key = element_blank(),
 legend.position = "bottom",
 legend.margin = margin(0,0,0,0),
 # adjust text size
 text = element_text(size = 8),
 title = element_text(size = 8),
 legend.title = element_text(size = 7)
)
```

<!-- # Overview of sections -->

<!-- Intro -->

<!-- - This is missingness -->

<!-- - This is how we solve missingness -->

<!-- - For that we need an algorithm, but what if it has not converged? -->

<!-- - That is what we solve in this paper -->


<!-- Algorithmic convergence -->

<!-- - What is algorithmic convergence? -->

<!-- - When is it converged? Stationarity versus mixing. -->

<!-- - How is convergence currently investigated? And how should it be investigated? Multivariate versus univariate. -->


<!-- Methods -->

<!-- - Which methods are there? And how do they relate to mixing and stationarity? -->

<!-- - $\widehat{R}$ -->

<!-- - AC -->

<!-- - We can use these on any $\theta$ -->


<!-- Then Simulation study, Results, Discussion. -->


# Introduction

Anyone who analyzes person-data may run into a missing data problem. Missing data is not only ubiquitous across science, but treating it can also be a tedious task. If a dataset contains just one incomplete observation, calculations are not defined, and statistical models cannot be fitted to the data. To circumvent this, many statistical packages employ list-wise deletion by default (i.e., ignoring incomplete observations). Unfortunately, this *ad hoc* solution may yield invalid results [@buur18]. An alternative is to apply imputation. With imputation, we 'fill in' the missing values in an incomplete dataset. Subsequently, the model of scientific interest can be fitted to the completed dataset. By repeating this process several times, a distribution of plausible results may be obtained, which reflects the uncertainty in the data due to missingness. This technique is known as 'multiple imputation' [MI; @rubin76]. MI has proven to be a powerful tool to draw valid inferences from incomplete data under many circumstances [@buur18]. 

Figure \ref{fig:diagram} provides an overview of the steps involved with MI. The missing part $y_{\rm mis}$ of an incomplete dataset is imputed $m$ times. This creates $m$ sets of imputed data $\dot y_{\rm imp, \ell}$, where $\ell = 1, 2, ..., m$. The imputed data is then combined with the observed data $y_{\rm obs}$ to create $m$ completed datasets. On each of these datasets the analysis of scientific interest is performed to estimate $Q$: the quantity of scientific interest (e.g., a regression coefficient). Since $Q$ is estimated on each completed dataset, $m$ separate $\hat{Q}_\ell$-values are obtained. Finally, the $\hat{Q}_\ell$-values are combined into a single pooled estimate $\bar{Q}$. The premise of multiple imputation is that $\bar{Q}$ is an unbiased and confidence-valid estimate of the true---but unobserved---scientific estimand $Q$ [@rubin96].

<!-- $Q$ is quantity of scientific interest: "A scientific estimand $Q$ is a quantity of scientific interest that we can calculate if we would observe the entire population" [@buur18, par 2.3.1] -->

```{r diagram, out.width="\\linewidth", include=TRUE, fig.cap="Scheme of the main steps in multiple imputation---from an incomplete dataset, to $m=3$ multiply imputed datasets, to $m=3$ estimated quantities of scientific interest $\\hat{Q}$, to a single pooled estimate $\\bar{Q}$."}
knitr::include_graphics("../Figures/DiagramMI.pdf") #adapted from [@buur18] par. 1.4.1.
```

A popular method to obtain imputations is to use the 'Multiple Imputation by Chained Equations' algorithm, shorthand 'MICE'[@mice]. With MICE, imputed values are drawn from the posterior predictive distribution of the missing values. The algorithm is named after its iterative nature: a multivariate distribution is obtained by iterating over a sequence of univariate imputations. Iteration, however, also introduces a potential threat to the validity of the imputations: What if the algorithm has not converged? Are the imputations then to be trusted? And can we rely on the inference obtained on the completed data? 
<!-- $\dot y_{\rm imp, \ell}$ $y_{\rm mis}$ -->

These remain open questions since the convergence properties of iterative imputation algorithms have not been systematically studied [@buur18]. There is no scientific consensus on how to evaluate the convergence of imputation algorithms [@zhu15; @taka17]. Moreover, the behavior of such algorithms under certain default imputation models (e.g., 'predictive mean matching') is an entirely open question [@murr18]. Therefore, algorithmic convergence should be monitored carefully---although this is not straightforward. Iterative imputation algorithms such as MICE are special cases of Markov chain Monte Carlo (MCMC) methods. In MCMC methods, convergence is not from a scalar to a point, but from one distribution to another. The values generated by the algorithm (e.g., imputed values) will vary even after convergence [@gelm13]. Since MCMC algorithms do not reach a unique point at which convergence is established, diagnostic methods may only identify signs of *non*-convergence [@hoff09]. Several non-convergence diagnostics exist, but it is not known whether these are appropriate within the imputation framework. 
<!-- "a weak diagnostics is better than no diagnostic at all" [@cowl96]. -->

In this paper we study different methods for assessing non-convergence in iterative imputation algorithms. We define several diagnostics and evaluate how these diagnostics could be appropriate for iterative imputation applications. We then address the impact of inducing non-convergence in iterative imputation algorithms through model-based simulation in `R` [@R]. For reasons of brevity, we only focus on the iterative imputation algorithm implemented in the popular `mice` package in `R` [@mice]. The aim of the simulation study is to determine whether unbiased, confidence-valid inferences may be obtained if the algorithm has not (yet) converged. And additionally, to evaluate the behavior and performance of several diagnostic methods to identify non-convergence. With that, we formulate an informed advice on when it is safe to conclude that the algorithm is converged *enough* for valid inferences. We translate the results of the study into guidelines for applied researchers, which may facilitate drawing valid inferences from incomplete data. 

<!-- The results of this study are guidelines for identifying non-convergence in iterative imputation algorithms, which will aid applied researchers in drawing valid inference from incomplete datasets. -->

<!-- **[Include sub-questions and make structure of the paper clear!]** How can non-convergence be identified diagnostically? Are common MCMC non-convergence diagnostics appropriate for MICE? And if so, which threshold should be used to diagnose non-convergence? How many iterations are sufficient/needed to be able to diagnose non-convergence? Are the default number of iterations sufficient (i.e., 5 in mice, 10 in SPSS and Stata, 30 in mi)? How severe is it when the algorithm has not converged? And what are guidelines for practice? Can the parameter of interest $Q$ be correct when the algorithm is not (yet) converged, and vice versa? -->

<!-- The defaults of common MI software: SPSS = 10 [(link)](https://www.ibm.com/support/knowledgecenter/SSLVMB_24.0.0/spss/mva/syn_multiple_imputation_impute.html), Mplus = 100?? [(link)](https://pdfs.semanticscholar.org/e20e/29e008592cbfbaa567931f74cdfdb5451405.pdf?_ga=2.55354671.54033656.1584698748-527613517.1584698748), Stata = 10 [(link)](https://www.stata.com/manuals13/mi.pdf, p. 139), Amelia = NA, because re-sampling, not convergence [(link)](https://cran.r-project.org/web/packages/Amelia/Amelia.pdf), en MI = 30 [(link)](https://cran.r-project.org/web/packages/mi/mi.pdf). -->

<!-- The goal of this research project is to develop novel methodology and guidelines for evaluating MI methods. These tools will subsequently be implemented in an interactive evaluation framework for multiple imputation, which will aid applied researchers in drawing valid inference from incomplete datasets. -->


## Some notation

Let $y$ denote an $n \times k$ matrix containing the data values on $k$ variables for all $n$ units in a sample. The data value of unit $i$ ($i = 1, 2, \dots, n$) on variable $j$ ($j = 1, 2, \dots, k$) may be either observed or missing. The number of units $i$ with at least one missing value, divided by the total number of units $n$, is called the proportion of incomplete cases $p_{\rm inc}$ in dataset $y$. The collection of observed data values in $y$ is denoted by $y_{\rm obs}$; the missing part of $y$ is referred to as $y_{\rm mis}$. For each datapoint in $y_{\rm mis}$, we sample $m \times T$ plausible values, where $m$ is the number of imputations ($\ell = 1, 2, \dots, m$) and $T$ is the number of iterations in the imputation algorithm ($t = 1, 2, \dots, T$). The state-space of the algorithm at a certain iteration $t$ may be summarized by a scalar summary $\theta$ (e.g., the average of the imputed values). The collection of $\theta$-values between $t=1$ (summarizing the state-space of the algorithm at initialization) and $t=T$ (summarizing the state-space for the imputed values) will be referred to as an 'imputation chain'. 
<!-- **[If not defined elsewhere, add: $\theta$s are scalar summaries of the algorithm at a certain iteration (e.g., chain means; the average of the imputed values in each imputation chain).] ** -->



# Algorithmic non-convergence

There are two requirements for convergence of iterative algorithms: mixing and stationarity [@gelm13]. In iterative imputation algorithms, mixing implies that imputation chains intermingle nicely, and stationarity is characterized by the absence of trending across iterations. If one of the two requirements is not met, we speak of non-convergence. Without mixing, chains may be 'stuck' at a local optimum, instead of sampling imputed values from the entire predictive posterior distribution of the missing values. The distribution of imputed values then differs across imputations. This may cause under-estimation of the variance between chains, which results in spurious, invalid inferences. Without stationarity, there is trending within imputation chains. Trending implies that further iterations would yield a systematically lower or higher set of imputations. Iterative imputation algorithms that have not (yet) reached stationarity, may thus yield biased estimates.

<!-- When we declare approximate convergence, we are actually concluding that each individual sequence appears stationary and that the observed sequences -->
<!-- have mixed well with each other. @gelm13, p. 288-->


<!-- **The goal of imputation through e.g. MICE is to obtain a multivariate distribution by iterating over a sequence of univariate imputations. Traditionally, the inspection of the multivariate convergence is done by visually inspecting the univariate chain means and variances over the iterations. The downside to these approaches is that they either focus on the univariate state-space, or primarily track the change over the iterations of a multivariate outcome conform the scientific model of interest. Focusing on the convergence of these outcome parameters may influence this procedure in the sense that the model of evaluation favors the model of interest. Ideally, one would like to evaluate a model-independent parameter that summarizes the multivariate nature of the data. We propose eigenvalue as such a parameter, because it.... ** -->

To illustrate what non-mixing and non-stationarity look like in iterative imputation algorithms, we reproduce an example from van Buuren [-@buur18, $\S$ 6.5.2]. Figure \ref{fig:non-conv} displays two scenarios from the example. The panel on the left-hand side of the figure shows typical convergence of an iterative imputation algorithm. The right-hand side displays pathological non-convergence, induced by purposefully mis-specifying the imputation model. Each line portrays one imputation chain (i.e., the values of a scalar summary $\theta$ across iterations). The $\theta$ depicted here is the 'chain mean' of variable $j$, which is defined as the average of variable $j$ in the $m$ sets of imputations $\dot y_{\rm imp, \ell}$. 

In the typical convergence scenario, the imputation chains intermingle nicely and there is little to no trending. In the non-convergence scenario, there is a lot of trending and some chains do not intermingle. Importantly, the chain means at the last iteration (the imputed values per imputation $\ell$) are very different between the two scenarios. The algorithm with the mis-specified model yields imputed values that are on average a factor two larger than those of the typically converged algorithm. It is obvious that non-convergence in this example impacts the distribution of the imputed values per imputation $\dot y_{\rm imp, \ell}$. This effect may translate into the distribution of the $m$ sets of completed data {$y_{\rm obs}, \dot y_{\rm imp, \ell}$}, which consequently affects the estimated quantities of scientific interest $\hat{Q}_{\ell}$, and finally the pooled estimate $\bar{Q}$. $\bar{Q}$ is then a  biased, invalid estimate of $Q$. Therefore, it is important to reach algorithmic convergence in iterative imputation algorithms.

<!-- , since systematically higher imputed values lead to bias, and under-estimation of the variance within imputation chains poses a threat to confidence-validity. -->

```{r non-conv, out.width='.49\\linewidth', fig.width=3.5, fig.height=3,fig.show='hold',fig.cap="Typical convergence versus pathological non-convergence (reproduced from van Buuren; 2018). Depicted are chain means of variable $j$ in each imputation ($m=5$; $T=10$). Please note that any difference between the two scenarios (see e.g., the magnitude of the chain means on the y-axes) stems from the imputation algorithms---the two scenarios have equal incomplete data $y$."}
par(mar = c(2, 2, 0.1, 0.1))
con_plot
non_plot
```


## Identifying non-convergence

Currently, the recommended practice for evaluating the convergence of the MICE algorithm is through visual inspection. After running the imputation algorithm for a certain number of iterations, researchers are encouraged to produce traceplots. In a traceplot, a scalar summary of the state-space of the algorithm $\theta$ is plotted against the iteration number, as depicted in Figure \ref{fig:non-conv}. The default scalar summaries to inspect for the MICE algorithm are chain means and chain variances. Non-convergence is diagnosed if the imputation chains are not freely intermingled with one another, or if the chains show definite trends [@buur18, $\S$ 6.5.2]. 

Identifying non-convergence by inspecting traceplots may be undesirable for several reasons: 1) it may be challenging to the untrained eye, 2) only severely pathological cases of non-convergence may be diagnosed, and 3) there is not an objective measure that quantifies convergence [@buur18, $\S$ 6.5.2]. Moreover, traceplots are typically only used to inspect  univariate $\theta$s. Monitoring univariate summaries of the state-space of the algorithm may be insufficient because MICE is not only concerned with a single column, but the entire multivariate distribution of the imputations. Ideally, we would monitor a multivariate $\theta$. 

A suggestion by @buur18 for a multivariate $\theta$ to monitor is the estimated quantity of scientific interest $\hat{Q}$, which usually is multivariate in nature. This $\theta$ is computed as the estimate in each imputation, $\hat{Q}_\ell$, across iterations. Implementing this, however, might be somewhat too technical for empirical researchers. Besides, this scalar summary is not model-independent. That is, $\theta=\hat{Q}$ is not universal to all complete data problems, while one of the advantages of iterative imputation is that the missing data problem and scientific problem are solved independently. Focusing on the convergence of outcome parameters may influence the iterative imputation procedure in the sense that the model of evaluation favors the model of interest. On these grounds, such a $\theta$ can be considered insufficient too. 

As alternative, van Buuren [-@buur18, $\S$ 4.5.2] proposed multivariate evaluation of the MICE algorithm through eigenvalue decomposition, building on the work of @mack03. This technique may yield a model-independent, multivariate scalar summary to monitor, but it is not implemented in the  `mice` package [@mice]. 

<!-- Recommendation: "the different streams should be freely intermingled with one another, without showing any definite trends". -->

<!-- **[MERGE with sections above]** Convergence has historically been inspected visually, by monitoring the imputation algorithm over iterations. This is typically done through traceplots. In a traceplot, the iteration number is plotted against a certain $\theta$. $\theta$s are scalar summaries of the state-space of the algorithm at a specific iteration.  -->

<!-- The default scalar summaries in `mice` are chain means and chain variances. Additionally, researchers may "monitor some statistic of scientific interest" [@buur18, $\S$ 6.5.2]. As @buur18 describes, researchers can specify their quantity of scientific interest $Q$ (e.g., a regression coefficient) as scalar summary $\theta$. Such a user-defined scalar summary, however, may be somewhat advanced for empirical researchers.  -->

## A novel scalar summary

To monitor non-convergence in iterative imputation algorithms, we may  summarize the state-space of the algorithm with several $\theta$s. The downside to the current $\theta$s is that they either focus on the univariate state-space, or primarily track the change over the iterations of a multivariate outcome conform the scientific model of interest. Ideally, one would like to evaluate a model-independent $\theta$ that summarizes the multivariate nature of the data. 

We propose $\lambda_{1}$ as such a scalar summary. We define $\lambda_{1}$ as the first eigenvalue of the variance-covariance matrix in the $m$ completed datasets. The eigenvalues of a variance-covariance matrix $S$ summarize the total set of covariances in the data. Let $\lambda_{1, \ell} \geq \lambda_{2, \ell} \geq ... \geq \lambda_{j, \ell}$ be the eigenvalues of $S_\ell$ in each imputation. The first eigenvalue, $\lambda_{1,\ell}$, then summarizes the largest possible amount of covariance in each completed dataset {$y_{\rm obs}, \dot y_{\rm imp, \ell}$}. By definition, $\lambda_{1}$-values are equal to the variance of the first component that would be obtained by performing principal component analysis (PCA) on the completed data. As scalar summary, $\lambda_{1}$ has the appealing property that it is not dependent on the model of scientific interest, yet still summarizes the multivariate state-space of the algorithm. 

<!-- **Since convergence of iterative imputation algorithms is in distribution, there is not a unique point at which the algorithm reaches a converged state. We can only evaluate scalar summaries of the multivariate state-space of the algorithm, $\theta$s. The recommended scalar summaries to evaluate are chain means and chain variances. Additionally, researchers may "monitor some statistic of scientific interest" [@buur18, $\S$ 6.5.2]. Because of the issues mentioned above, we propose a novel $\theta$ to monitor: the first eigenvalue of the variance-covariance matrix of the completed data. Let $\lambda_{1, \ell} \geq \lambda_2 \geq ... \geq \lambda_j$ be the eigenvalues of $\Sigma$ in each of the $m$ completed datasets ${y_{\rm obs}, y_{\rm imp}}$. $\lambda_{1, \ell}$ is measure that summarizes the covariances in the completed datasets.**  -->

In this study, we consider each of the four $\theta$s that we discussed. Namely, two univariate scalar summaries (chain mean and chain variance), a model-dependent multivariate summary $\hat{Q}$, and the novel model-independent multivariate summary $\lambda_1$.


# Non-convergence diagnostics

<!-- Requirements for diagnostics to identify non-convergence in iterative imputation are: 1) work for a relatively low number of iterations (defaults in popular iterative imputation software between 5 and 30); 2) may be applied to different $\theta$s, including model-independent $\theta$s (e.g., chain mean, or eigenvalue). -->

There are many diagnostic tools to identify non-convergence in iterative (MCMC) algorithms [@broo98; @elad06]. We consider only two of them that may be appropriate for imputation algorithms---one to monitor signs of non-mixing, and one for non-stationarity. As recommended by e.g. @cowl96 we will use the potential scale reduction factor $\widehat{R}$ to evaluate mixing ['Gelman-Rubin statistic'; @gelm92], and autocorrelation to diagnose trending [$AC$; @scha97; @gelm13]. With a recently proposed adaptation, $\widehat{R}$ might also serve to diagnose non-stationarity, but this has not yet been thoroughly investigated [@veht19]. Therefore, we will evaluate the appropriateness of both $\widehat{R}$ versions, in addition to $AC$. Other methods are outside the scope of this study because they e.g. assume that values within chains represent independent samples, whereas the MICE algorithm only uses the final iteration to produce imputations. 

<!-- Non-stationarity within chains may be diagnosed with e.g., autocorrelation [$AC$; @scha97; @gelm13], numeric standard error ['MC error'; @gewe92], or Raftery and Lewis's [-@raft91] procedure to determine the effect of trending on the precision of estimates.  -->

<!-- A widely used diagnostic to monitor mixing between chains is the potential scale reduction factor $\widehat{R}$ ['Gelman-Rubin statistic'; @gelm92].  Therefore, we use $\widehat{R}$ **[WHICH? Explain that we'll use both]** and $AC$ to evaluate mixing and stationarity separately, as recommended by e.g., @cowl96. -->

<!-- **[Add: we don't use effective sample size and MC error because they assume independent samples *within* chains. In MI, we only use the final estimate. Also, computing n_eff assumes infinitely many iterations, which is fine in Bayesian analyses where T is often at least one thousand. But the default in iterative imp is often substantially lower.]** -->

## Potential scale reduction factor

In 2019, Vehtari et al. proposed an updated version of the potential scale reduction factor $\widehat{R}$, originally coined in 1992. The adapted version would be better suited to detect non-mixing in the tails of distributions, and even identify non-stationarity. This version uses three transformations on the scalar summary $\theta$, before computing $\widehat{R}$-values. Namely, rank-normalization, folding, and localization. The definition of the diagnostic itself is equal to the original $\widehat{R}$. Therefore, we may follow Vehtari et al.'s formulation (2019, p. 5) to define both $\widehat{R}$ versions. Let $m$ be the total number of chains, $T$ the number of iterations per chain (where $T\geq2$), and $\theta$ the scalar summary of interest. For each chain ($\ell = 1, 2, \dots, m$), we estimate the variance of $\theta$, and average these to obtain within-chain variance $W$. 

\begin{align*}
W&=\frac{1}{m} \sum_{\ell=1}^{m} s_{\ell}^{2}, \text { where } s_{\ell}^{2}=\frac{1}{T-1} \sum_{t=1}^{T}\left(\theta^{(t \ell)}-\bar{\theta}^{(\cdot \ell)}\right)^{2}. 
\end{align*}
<!-- %\text{ \cite[p.~5]{veht19}} -->

\noindent We then estimate between-chain variance $B$ (note that we diverge from the typical notation in MI, where $B$ denotes the variance between the estimated quantities of scientific interest $\hat{Q}_{\ell}$). $B$ is defined as the variance of the collection of average $\theta$s per chain: 

\begin{align*}
B&=\frac{T}{m-1} \sum_{\ell=1}^{m}\left(\bar{\theta}^{(\cdot \ell)}-\bar{\theta}^{(\cdot \cdot)}\right)^{2}, \text { where } \bar{\theta}^{(\cdot \ell)}=\frac{1}{T} \sum_{t=1}^{T} \theta^{(t \ell)} \text{, } \bar{\theta}^{(\cdot \cdot)}=\frac{1}{m} \sum_{\ell=1}^{m} \bar{\theta}^{(\cdot \ell)}. 
\end{align*}
<!-- %\text{ \cite[p.~5]{veht19}} -->

\noindent From the between- and within-chain variances we compute a weighted average, $\widehat{\operatorname{var}}^{+}$, which over-estimates the total variance of $\theta$. $\widehat{R}$ is then obtained as a ratio between this total variance and the within-chain variance:

\begin{equation*}
\widehat{R}=\sqrt{\frac{\widehat{\operatorname{var}}^{+}(\theta | y)}{W}},
\text{ where } \widehat{\operatorname{var}}^{+}(\theta | y)=\frac{T-1}{T} W+\frac{1}{T} B.
\end{equation*}

We can interpret $\widehat{R}$ as potential scale reduction factor since it indicates by how much the variance of $\theta$ could be shrunken down if an infinite number of iterations per chain would be run [@gelm92]. The assumption underlying this interpretation is that chains are 'over-dispersed' at $t=1$, and reach convergence as $T \to \infty$. Over-dispersion implies that the initial values of the chains are 'far away' from the target distribution and each other. When the sampled values in each chain are independent of the chain's initial value, the mixing component of convergence is satisfied. The variance between chains, $B$, is then equivalent to the variance within chains, $W$, and $\widehat{R}$-values will be close to one. High $\widehat{R}$-values thus indicate non-convergence. 


## Autocorrelation

Autocorrelation is defined as the correlation between two subsequent $\theta$-values within the same chain [@lync07, p. 147]. In this study, we only consider $AC$ at lag 1, i.e., the correlation between the $t^{th}$ and $(t+1)^{th}$ iteration of the same chain. Following the same notation as for $\widehat{R}$,

\begin{equation*}
AC = \left( \frac{T}{T-1} \right) \frac{\sum_{t=1}^{T-1}(\theta_t - \bar{\theta}^{(\cdot m)})(\theta_{t+1} - \bar{\theta}^{(\cdot m)})}{\sum_{t=1}^{T}(\theta_t - \bar{\theta}^{(\cdot m)})^2}.
\end{equation*}

We can interpret $AC$-values as a measure of non-stationarity. If there is dependence between subsequent $\theta$-values in imputation chains, $AC$-values are non-zero. Positive $AC$-values occur when $\theta$-values are recurring (i.e., high $\theta$-values are followed by high $\theta$-values, and low $\theta$-values are followed by low $\theta$-values). Recurrence within imputation chains may lead to trending. Negative $AC$-values occur when $\theta$-values of subsequent iterations are less similar, or diverge from one another. Divergence within imputation poses no threat to the convergence of the algorithm---it may even speed up convergence. Complete stationarity is reached when $AC=0$. As non-convergence diagnostic, our interest is in positive $AC$-values. 

<!-- close to zero indicate  independence between subsequent $\theta$s in imputation chains.  -->

<!-- Negative $AC$-values show no threat to the stationarity component of convergence. On the contrary even---negative $AC$-values indicate that $\theta$-values of subsequent iterations diverge from one another, which may increase the variance of $\theta$ and speed up convergence. As convergence diagnostic, the interest is therefore in positive $AC$-values.  -->

<!-- Positive $AC$-values occur when $\theta$-values of subsequent iterations are similar. When , we speak of recurrence. Recurrence within imputation chains indicates trending. Ergo, non-stationarity may be diagnosed when $AC$-values are larger than zero. -->

<!-- Negative $AC$-values indicate divergence within imputation chains. **Subsequent sampled values within each imputation chain are less alike.** Positive $AC$-values indicate recurrence. If $\theta$-values of subsequent iterations are similar, trending may occur.  -->


## Thresholds

<!-- We assume that complete convergence, defined as $\widehat{R} = 1$ and $AC = 0$, will not be observed.  -->
It is unlikely that iterative algorithms such as MICE will achieve the ideal values of $\widehat{R}=1$ and $AC=0$. Because of its convergence to a distribution, the algorithm will show some signs of non-mixing and non-stationarity even in the most converged state. The aim, therefore, is to reach approximate convergence [@gelm13]. Upon approximate convergence, the imputation chains intermingle such that the only difference between the chains is caused by the randomness induced by the algorithm ($\widehat{R} > 1$), and there is little dependency between subsequent iterations of imputation chains ($AC > 0$). In practice, we diagnose non-convergence when approximate convergence is violated, i.e., when $\widehat{R}$ and $AC$ exceed a certain threshold. The conventional thresholds to diagnose non-mixing are $\widehat{R} > 1.2$ [@gelm92] or $\widehat{R} > 1.1$ [@gelm13]. @veht19 proposed a much more stringent threshold of $\widehat{R} > 1.01$. The magnitude of $AC$-values may be evaluated statistically, using a Wald test with $AC=0$ as null hypothesis [@box15]. $AC$-values that are significantly higher than zero indicate non-stationarity.

<!-- We assess discrepancy from convergence via practical significance (or some conventional version thereof, such as Rh > 1.1) @gelm13, p. 288 -->

<!-- We can use effective sample size ^neff to give us a sense of the precision obtained from our simulations. As we have discussed in Section 10.5, for many purposes it should suffice to have 100 or even 10 independent simulation draws. (If neff = 10, the simulation standard error is increased by p 1 + 1/10 = 1.05). As a default rule, we suggest running the simulation until ^neff is at least 5m, that is, until there are the equivalent of at least 10 independent draws per sequence (recall that m is twice the number of sequences, as we have split each sequence into two parts so that Rb can assess stationarity as well as mixing). Having an effective sample size of 10 per sequence should typically correspond to stability of all the simulated sequences.  @gelm13, p. 287 -->

## In practice

Before we evaluate the performance of the non-convergence diagnostics $\widehat{R}$ and $AC$ quantitatively through simulation, we first assess their appropriateness qualitatively. We do this by applying them to the example of pathological non-convergence that we reproduced form @buur18. Ideally, the diagnostics are as informative as, or better than visual inspection of the traceplots. The methods should at least indicate worse performance (higher $\widehat{R}$- and $AC$-values) for the scenario with pathological non-convergence, compared to the typically converged algorithm. 

Each panel in Figure \ref{fig:diagnostics} depicts one method to identify non-convergence, applied to the two scenarios from Figure \ref{fig:non-conv}. Panel A consists of the two traceplots that may be evaluated through visual inspection. Panel B shows two versions of the $AC$: the default calculation with `R` function `stats::acf()` [@R], and manual calculation as the correlation between $\theta$ in iteration $t$ and $\theta$ in iteration $t+1$. Panel C displays the traditional computation of $\widehat{R}$ conform Gelman and Rubin (original), and in panel D we see $\widehat{R}$ as computed by implementing Vehtari et al.'s recommendations (adapted). 


```{r diagnostics, fig.cap="Convergence diagnostics applied on the two scenarios from Figure 2 ($\\theta$ = chain mean of variable $j$; $m=5$; $T=10$). Depicted are the imputation chains in panel A, two versions of the autocorrelation in panel B, and two versions of $\\widehat{R}$ in panels C and D."}
# load("./images/diagnostics_plot.Rdata") #bquote(theta ~ "= chain mean in "~ y[imp][",m"])
(theta + plot_layout(guides = "collect", ncol = 2)) + (ac_both + plot_layout(guides = "keep")) + old_rhat + new_rhat +  plot_annotation(tag_levels = "A", tag_suffix = ".") # add 'ncol=1' for plots under each other
```


By visually inspecting the imputation chains in panel A, we conclude that the two scenarios show very different convergence. The typically converged algorithm initially portrays some signs of non-mixing (around $t=2$), but intermingles nicely overall. Additionally, there is very little trending in this scenario. The algorithm with pathological non-convergence shows severe non-mixing, although this gradually improves (beyond $t=7$). In this scenario, we see a lot of trending initially (up-to $t=6$), after which the chains reached a somewhat more stationary state. 

When we look at panel B, we conclude something weird. The $AC$-values calculated with the default function indicate equal performance for the typical convergence and the pathological non-convergence scenarios (up-to $t=5$), while there is obvious trending in the $\theta$s of the latter. Moreover, the best convergence (as indicated by the lowest $AC$-value) is observed at $t=2$ for both scenarios. However, if we look at the chain means of the non-convergence scenario, there should be signs of trending  up-to iteration number seven. After consulting the documentation on `stats::acf()`, we conclude that this $AC$ function is not suited for iterative imputation algorithms. The function is optimized for performance when $t\geq50$ [@box15], while the default number of iterations in iterative imputation is often much lower. Therefore, we compute $AC$ manually (presented with solid lines in panel B). These $AC$-values behave as expected from visual inspection. We will, therefore, only consider manually calculated $AC$-values as non-convergence diagnostic.

In panel C, we do not see a lot of difference between the two scenarios either. The $\widehat{R}$-values are even somewhat lower for the non-convergence scenario than for the typical convergence. And apparently, the large variance causes an increase in $\widehat{R}$-values. Convergence seems to worsen with every additional iteration. This paints the wrong picture. An explanation for this behavior may be that under severe trending, the assumption of over-dispersion is violated. Taken together, this version of $\widehat{R}$ is sub-optimal for assessing non-convergence in MI.

The $\widehat{R}$-values in panel D are conform our expectations. The adapted version of $\widehat{R}$ depicted here does indicate less signs of non-convergence as the number of iterations goes up. An exception to this general trend is the 'dip' around $t=3$. As diagnostic tool, this may lead to the incorrect conclusion that the non-convergence scenario has superior convergence compared to the typical scenario. We can explain this as a downside of the low number of iterations in iterative imputation: the adapted version of $\widehat{R}$ can only be completely employed if the number of iterations is at least four. Otherwise, it is not possible to perform all three transformations to the chains of $\theta$-values. For low values of $t$, the $\widehat{R}$-values conform Vehtari et al. are, therefore, more similar to the original $\widehat{R}$ by Gelman and Rubin.
<!-- However, the superior performance of the typical convergence over the pathological non-convergence is less prominent, even flipped for $t<4$.  -->

In short, both non-convergence diagnostics have a version that may be appropriate for iterative imputation algorithms. We will compute $\widehat{R}$ conform @veht19, and calculate $AC$ manually. The diagnostics will be applied to the four types of scalar summaries $\theta$ described earlier: chain means, chain variances, a quantity of scientific interest, and the first eigenvalue of the variance-covariance matrix. We evaluate the performance of these eight sets of diagnostic methods (two diagnostics; four $\theta$s) through simulation.




# Simulation study

The simulation study aims to determine to what extend non-convergence affects iterative imputation algorithms. Specifically, we are interested in the validity of inferences drawn from incomplete data using the MICE algorithm. And, whether invalid inferences due to non-convergence may be detected using eight sets of diagnostic methods. If the estimated quantities of scientific interest $\bar{Q}$ are unbiased and confidence-valid estimates of ${Q}$, we will conclude that the algorithm is sufficiently converged for practical purposes. In contrast to this, we defined *approximate* convergence as the most converged state that the algorithm can obtain. Continued iteration after reaching approximate convergence does not yield better mixing or stationarity (indicated by non-improving $\widehat{R}$- and $AC$-values). Continued iteration after obtaining valid inferences may lead to a more converged state of the algorithm, but not better estimates.

<!-- is an unbiased and confidence-valid**[REMOVE?] Subsequently we will evaluate how well $\widehat{R}$ and $AC$ perform in identifying the effects of non-convergence **[and performance of different thetas]**. And finally, we will formulate an informed advice on the requirements to safely conclude sufficient convergence in practice. That is, we conclude that  convergence is sufficient when each estimate $\bar{Q}$ is an unbiased and confidence-valid estimate of the corresponding estimand $Q$.** -->

To induce non-convergence, we consider two sets of simulation conditions: 'missingness' and 'early stopping'. Missingness refers to the severity of the missing data problem, which we determine by the proportion of incomplete cases in dataset $y$, $p_{\rm inc}$. Early stopping is defined by the number of iterations in the imputation algorithm, $T$.   

<!-- **["early stopping" en "proportion of complete cases"]** :  -->

<!-- we vary the missingness proportion $p_{\rm inc}$ in the incomplete data, and we vary the number of iterations $T$ in the imputation algorithm.  -->

The missingness conditions are chosen to reflect the difficulty of the missingness problem. The underlying assumption is that a low proportion of incomplete cases $p_{\rm inc}$ leads to quick algorithmic convergence, since there is a lot of information in the observed data. A higher $p_{\rm inc}$ yields slower convergence---unless there is so little information in $y_{\rm obs}$ that this is outweighed by the random component in the imputation algorithm. Then, convergence to a stable but highly variable state may be reached instantly. Still, we expect that missingness conditions with higher $p_{\rm inc}$ will result in more signs of non-convergence.

The assumption inherent to the early stopping conditions is that terminating the imputation algorithm too early causes non-convergence. Generally, the algorithm will not reach convergence if $T=1$, because the imputed values in the first iteration (at $t=1$) depend on the starting values [which are sampled randomly from the set of observed datapoints; @buur18]. As the number of iterations increases, the imputation chains should become independent of the initial values, until approximate convergence is reached (i.e., when an additional iteration does not lead to a more converged state). We expect that we can induce non-convergence by early stopping in at least those conditions where $T$ is smaller than the default number of iterations in `mice`, $T=5$ [@mice]. 

<!-- **[REMOVE?] $Q$s are the targets that will be estimated in each simulation repetition, after first *amputing* the complete data with varying missingness proportions, then imputing the missingness with a varying number of iterations, then estimating the $Q$s on the $m$ completed datasets, and finally pooling the $m$ estimates $\hat{Q}_\ell$ to obtain a single $\bar{Q}$ for each $Q$. We try to predict the effect of non-convergence (i.e., the difference between $Q$ and $\bar{Q}$) with the convergence diagnostics $\widehat{R}$ and $AC$, by applying these methods to several scalar summaries of the state-space of the algorithm, $\theta$s.** -->

## Hypotheses 

1. We expect that simulation conditions with a high proportion of incomplete cases $p_{\rm inc}$ and a low number of iterations $T$ will more often result in biased, invalid estimates of the quantities of scientific interest $Q$. 

2. We hypothesize that $\widehat{R}$ and $AC$ will correctly identify signs of non-convergence in those simulation conditions where any $\bar{Q}$ is *not* an unbiased and confidence-valid estimate of $Q$.

3. We hypothesize that the recommended thresholds to diagnose non-convergence with $\widehat{R}$ ($\widehat{R} > 1.2$, $\widehat{R} > 1.1$, and $\widehat{R} > 1.01$) may be too stringent for iterative imputation applications. In an empirical study, where $\widehat{R}$ was used to inform the required imputation chain length, it took as many as 50 iterations to overcome the conventional non-convergence threshold $\widehat{R}>1.2$. Yet, scientific estimates were insensitive to continued iteration from $t=5$ onward [@lace07]. We, therefore, suspect that $\widehat{R}$ may over-estimate signs of non-convergence in iterative imputation algorithms, compared to the validity of estimates. In contrast to this, signs of non-convergence can be under-estimated by $\widehat{R}$, in exceptional cases where the initial values of the algorithm are not appropriately over-dispersed [@broo98, p. 437]. In  `mice`, initial values are chosen randomly from the observed data, hence we cannot be certain of over-dispersion in the initial values. In practice, we do not expect this to cause problems for identifying non-convergence with $\widehat{R}$. 

4. We expect that high $AC$-values are implausible in iterative imputation algorithms with typical convergence. After only a few iterations, the randomness induced by the algorithm should effectively mitigate the risk of dependency within chains.

5. We further hypothesize that multivariate $\theta$s are better at detecting non-convergence than univariate $\theta$s. 

<!-- **(bruggetje hier)** For multiple imputation algorithms, it holds that convergence is reached when there is no dependency between subsequent iterations of imputation chains ($AC = 0$), and chains intermingle such that the only difference between the chains is caused by the randomness induced by the algorithm ($\widehat{R} = 1$). **We expect that a completely converged state will not be reached.**  -->

<!-- This study evaluates whether $\widehat{R}$ and $AC$ could diagnose convergence of multiple imputation algorithms. We assess the performance of the two convergence diagnostics against the recommended evaluation criteria for MI methods [i.e., average bias, average confidence interval width, and empirical coverage rate across simulations; @buur18, $\S$ 2.5.2]. **That is, there is no baseline measure available to evaluate performance against.** -->

<!-- We could also look at distributional characteristics, and plausibility of imputed values, see @vinknd. For now, this is outside of the scope of this study. -->

<!-- Based on an empirical finding [@lace07], we hypothesize that $\widehat{R}$ will over-estimate non-convergence of MI algorithms **explain why?**. Lacerda concluded that rhat dropped below 1.2 after at least 50 iterations. Therefore we hypothesize that Vehtari's proposed threshold of $\widehat{R} < 1.01$ will be too stringent for diagnosing convergence in iterative imputation. This over-estimation may, however, be diminished because $\widehat{R}$ can falsely diagnose convergence if initial values of the algorithm are not appropriately over-dispersed [@broo98, p. 437]. In e.g. `mice`, initial values are chosen randomly from the observed data. Therefore, we cannot be certain that the initial values are over-dispersed. We expect this to have little effect on the hypothesized performance of $\widehat{R}$. **(Add actual hypothesis: we thought that mice would converge sooner than $\widehat{R}$ would indicate that it did). On the one hand, $\widehat{R}$ is known to under-estimate signs of non-convergence when the initial values of the algorithm are not appropriately over-dispersed [@broo98, p. 437], which may be the case for iterative imputation algorithms. In e.g. `mice`, initial values are chosen randomly from the observed data. Therefore, we cannot be certain that the initial values are sufficiently over-dispersed. 
**  -->



## Set-up

We investigate non-convergence of the MICE algorithm through model-based simulation in `R` [version 3.6.3; @R]. The number of simulation repetitions is 1000, and the simulation set-up is summarized in the pseudo-code below. The complete `R` script of the simulation study is available from [github.com/hanneoberman/MissingThePoint](https://github.com/hanneoberman/MissingThePoint). 

```
# pseudo-code of simulation 
1. simulate data 
for (number of simulation runs from 1 to 1000)
 for (missingness proportions 5%, 25%, 50%, 75% and 95%)
  2. create missingness
  for (number of iterations from 1 to 100)
   3. impute missingness
   4. perform analysis of scientific interest
   5. compute non-convergence diagnostics 
   6. pool results across imputations
   7. compute performance measures
 8. combine outcomes of all missingness proportions
9. aggregate outcomes of all simulation runs 

```
### Data-generating mechanism.

In this study, sampling variance is not of interest. Therefore, a single complete dataset may serve as comparative truth in all simulation repetitions [@vink14]. The data-generating mechanism is a multivariate normal distribution, representing person-data on three predictor variables in a multiple linear regression problem. Let the predictor space be defined as 
$$
\begin{aligned}
\begin{pmatrix}X_1\\
X_2\\
X_3
\end{pmatrix} \sim \mathcal{N}
\begin{bmatrix}
\begin{pmatrix}
12\\
3\\
0.5
\end{pmatrix}\!\!,
\begin{pmatrix}
4 & 4 & 1.8 \\
4 & 16 & 4.8\\
1.8 & 4.8 & 9
\end{pmatrix}
\end{bmatrix}\!\!\text{.}\\[2\jot]
\end{aligned}
$$
A finite population of $N=1000$ is simulated using the `mvtnorm` package [@mvtnorm]. Subsequently, a fourth variable is constructed as outcome variable $Y$. For each unit $i = 1, 2,..., N$, let 
$$
Y_i = 1 + 2X_{1i} +.5X_{2i} - X_{3i} + \epsilon_i ,
$$
where $\epsilon \sim \mathcal{N}(0, 100)$. This results in a dataset $y$, where $y_{\rm mis} = \emptyset$. In other words, $y$ contains the complete set of observations for all units $i$ on all variables $j$ (where $j =  Y, X_1, X_2, X_3$). From the complete dataset we obtain the true values of the scientific estimands $Q$. 



### Scientific estimands.

We consider four types of $Q$s that are often of interest in empirical research. Namely, two descriptive statistics: the mean $\mu_j$ and standard deviation $\sigma_j$ of each variable $j$. We also consider the regression coefficients of the predictors: $\beta_1$, $\beta_2$, and $\beta_3$ in regression equation
$$Y' = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3,$$
where $Y'$ is the expected value of the outcome. The final estimand is the proportion of variance explained by the set of predictors: coefficient of determination $r^2$ (note that lower case $r$ is used to avoid confusion with non-convergence diagnostic $\widehat{R}$). The scientific estimands are estimated by $\bar{Q}$ in each simulation condition.

<!-- Each of these $Q$s is estimated with a corresponding $\bar{Q}$, after the complete dataset is first *amputed* (with a varying missingness proportion $p_{\rm inc}$) and subsequently imputed (with a varying number of iterations $T$).  -->


### Simulation conditions.

In each simulation repetition, we *ampute* the complete dataset conform the missingness conditions. The proportion of incomplete cases $p_{\rm inc}$ varies between 5% and 95%, in incremental steps ($p_{\rm inc}$ = .05, .25, .50, .75, .95). We consider all possible univariate and multivariate patterns of missingness, conform a 'missing completely at random' missingness mechanism [MCAR; @rubin87]. I.e., the probability to be missing is the same for all $N \times k$ cells in $y$, conditional on $p_{\rm inc}$. We use the 'mice' package [function `mice::ampute()`; @mice] to obtain an incomplete dataset {$y_{\rm obs}, y_{\rm mis}$} for each of the five missingness conditions. 

We impute the missing values in {$y_{\rm obs}, \dot y_{\rm mis}$} according to the early stopping conditions. That is, we vary the number of iterations in the imputation algorithm between one and one hundred ($T = 1,2,.,100$). All imputation procedures are performed using `mice` [function `mice()`; @mice], with Bayesian linear regression imputation, and five imputation chains ($m=5$). This results in $m=5$ sets of imputations for each of the one hundred early stopping conditions, $\dot y_{\rm imp, \ell}$. 

Subsequently, we obtain the completed data per imputation, {$y_{\rm obs}, \dot y_{\rm imp, \ell}$}, by combining the imputed data with the observed data [function `mice::complete()`; @mice]. We estimate univariate $Q$s directly from the completed data, by averaging across imputations to obtain $\bar{Q}$. Estimates of multivariate $Q$s are obtained after performing multiple linear regression [function `stats::lm()`, @R]. We pool the resulting estimates, $\hat{Q}_\ell$, into a single $\bar{Q}$ conform @vink14.

<!-- In each simulation repetition, we *ampute* the complete dataset five times to obtain five different incomplete datasets, $y$s. The ratio between $y_{\rm obs}$ and $y_{\rm mis}$ in each $y$ depends on the missingness proportion: $p_{\rm inc} =.05,.25,.5,.75,.95$. We ampute the complete data with the `mice` package [function `mice::ampute()`; @mice]. We consider all possible univariate and multivariate patterns of missingness, conform a 'missing completely at random' missingness mechanism [@rubin87]. I.e., the probability to be missing is the same for all $N \times k$ cells in $y$, conditional on the missingness proportion $p_{\rm inc}$.  -->
<!-- <!-- This note only considers a 'missing completely at random' (MCAR) mechanism, where the probability of being missing is equal for all $n \times k$ cells in $y$ [@rubin87]. The probability to be missing is the same for all $n \times k$ cells in $y$ [a 'missing completely at random' missingness mechanism; @rubin87]. --> 

<!-- Missing datapoints in each incomplete dataset $y$ are imputed with the `mice()` function [@mice]. All imputation procedures are performed with Bayesian linear regression imputation, and five imputation chains ($m=5$). Because $m=5$, each run of the `mice()` function results in five sets of imputations: $\dot y_{\rm imp, \ell}$, where $m = 1, 2, ..., 5$. The number of iterations in each run of the algorithm varies between simulation conditions ($T=1,2,...,100$).  -->
<!-- <!-- Each repetition of the simulation thus starts from 1 complete dataset, then splits into 5 missingness conditions ($p_{\rm inc} =.05,.25,.5,.75,.95$), each of the amputed datasets is imputed 5 times ($m = 1, 2,..., 5$) for each iteration condition ($t = 1, 2,..., 100$). From these $5\times5\times100$ imputations, we extract the $\theta$s to apply $\widehat{R}$ and $AC$ on (**i.e., chain means, chain variances, $\beta$s per imputation, and the first eigenvalue of the variance-covariance matrix per imputation**).  --> 

<!-- From the 5 imputations $\dot y_{\rm imp, \ell}$ we obtain the chain means and chain variances for each variable $j$. These will serve as scalar summary $\theta$ to apply non-convergence diagnostics $\widehat{R}$ and $AC$ on. We then use `mice::complete()` to combine the imputed data $\dot y_{\rm imp, \ell}$ with the observed data $y_{\rm obs}$, resulting in five completed datasets {$y_{\rm obs}, y_{imp, m}$}. -->

<!-- On the 5 completed datasets {$y_{\rm obs}, y_{imp, m}$}, we:  -->

<!-- - Estimate $\hat{Q}_\ell$s for $Q= \mu$ and $Q=\sigma$ with `base::mean()`, and `stats::sd()` [@R]. We pool the $\hat{Q}_\ell$s with `base::mean()` to get $\bar{Q}$s. -->

<!-- - Compute $\lambda_{1, \ell}$, to use as $\theta$ in the two convergence diagnostics. By definition, the first eigenvalue of the variance-covariance matrix, $\lambda_{1, \ell}$, is equal to the variance of the principal component solution of each {$y_{\rm obs}, y_{imp, m}$}, which we calculate with `stats::princomp()` [@R].  -->

<!-- - Perform multiple linear regression with `stats::lm()` [@R] to get the $\hat{Q}_\ell$s for $Q=\beta$ and $Q=r^2$. We pool the $\hat{Q}_\ell$s conform @vink14 to get $\bar{Q}$s for the $\beta$s and $r^2$ **[check  finite pooling of  $r^2$, instead of `mice::pool.r.squared()`]**. Additionally, we use the $\hat{Q}_\ell$s of $Q=\beta$ as $\theta$ to apply the convergence diagnostics to. -->


<!-- <!-- After each run of the `mice` algorithm, the function `mice::complete()` is used to combine the imputed data $\dot y_{\rm imp, \ell}$ with the observed data $y_{\rm obs}$, resulting in five completed datasets {$y_{\rm obs}, y_{imp, m}$}.  --> 

<!-- <!-- The estimator for each $Q$ is $\bar{Q}$---the pooled aggregate of the $\hat{Q}_\ell$s across imputations. To calculate the $\bar{Q}$s, we combine the observed data $y_{\rm obs}$ and the imputed data for each imputation $\dot y_{\rm imp, \ell}$ with the function `mice::complete()`. Descriptive statistics are computed as the average across imputations for each variable ($\mu_j$ and $\sigma_j$, where $j = Y, X_1, X_2, X_3$). Estimated regression coefficients are obtained with the function `stats::lm()` for each imputation, and then pooled conform @vink14. The coefficient of determination is estimated for each imputation, and pooled using `mice::pool.r.squared()`.  --> 

<!-- We apply non-convergence diagnostics $\widehat{R}$ and $AC$ to each scalar summary $\theta$. We calculate $\widehat{R}$ by implementing Vehtari et al.'s [-@veht19] recommendations, and $AC$ as the correlation between the $t^{th}$ and the $(t+1)^{th}$ iteration.  -->


### Methods.

We consider eight sets of diagnostic methods to identify non-convergence, by applying $\widehat{R}$ and $AC$ on four different $\theta$s. Univariate $\theta$s are obtained from $\dot y_{\rm imp, \ell}$. The model-independent multivariate $\theta$, $\lambda_{1}$, is obtained from {$y_{\rm obs}, \dot y_{\rm imp, \ell}$} as the variance in the first PCA component [function `stats::princomp`; R]. The model-dependent multivariate $\theta$ is one of the quantities of scientific interest: the estimated regression coefficients in {$y_{\rm obs}, \dot y_{\rm imp, \ell}$}. We apply the two non-convergence diagnostics on the $\theta$s by implementing the adapted version of $\widehat{R}$ and by manually programming the $AC$ function. 


### Performance measures. 

As recommended by @buur18, we evaluate the performance of the imputation algorithm with bias, coverage rate (CR), and confidence interval width (CIW). Bias is calculated for each $Q$, whereas CR and CIW are only obtained for $Q = \beta$. We calculate bias as $\bar{Q} - Q$. CR is defined as the percentage of simulation repetitions in which the 95\% confidence interval (CI) around $\bar{Q}$ covers the true estimand $Q$. Let
$$\text{CI} = \bar{Q} \pm t_{(m-1)} \times \rm SE_{\bar{Q}},$$
where $t_{(M-1)}$ is the quantile of a $t$-distribution with $m-1$ degrees of freedom, and $\rm SE_{\bar{Q}}$ is the square root of the pooled variance estimate. If we obtain nominal coverage (CR = 95%), we can conclude that $\bar{Q}$ is a confidence-valid estimate of $Q$. Finally, we inspect CI width (CIW): the difference between the lower and upper bound of the 95\% confidence interval around $\bar{Q}$. CIW is of interest because it is a measure of efficiency. Under nominal coverage, short CIs are preferred, since wider CIs indicate lower statistical power.

We evaluate the diagnostic methods to identify non-convergence against these performance measures. $\widehat{R}$ and $AC$ should identify non-convergence in simulation conditions, where $\bar{Q}$ is *not* an unbiased, confidence-valid estimate of $Q$. 

<!-- We measure the performance of $\widehat{R}$ and $AC$ by the four scalar summaries $\theta$: chain means (i.e., the mean in each $y_{imp, m, j}$) versus $Q=\mu$, chain variances (i.e., the variance in each $y_{imp, m, j}$) versus $Q=\sigma$, the estimated regression coefficients $\beta$ in each {$y_{\rm obs}, y_{imp, m}$} (i.e., a user-defined statistic of scientific interest $\hat{Q}_\ell$) against $Q=\beta$, and the first eigenvalue of the variance-covariance matrix in each {$y_{\rm obs}, y_{imp, m}$}, $\lambda_{1, \ell}$ versus $Q=r^2$.** -->

<!-- **[Remove this?] Primarily, we want to know what the effect is of inducing non-convergence on the estimated $Q$s. More specifically, we are interested in the bias of $\bar{Q}$ for all $Q$s and the confidence-validity of $\bar{Q}$ for $Q=\beta$. Therefore, we evaluate these performance measures against the simulation conditions (the number of iterations $T$ and the missingness proportion $p_{\rm inc}$). We look at averages across simulation repetitions. Secondly, we want to know if conditions in which the $Q$s are affected by non-convergence are also identified by the non-convergence diagnostics $\widehat{R}$ and $AC$. We do this, again, by looking at the performance measures for the $Q$s, but now we evaluate these against what $\widehat{R}$ and $AC$ indicate about signs of non-convergence in the $\theta$s.** -->


# Results

Our results show the performance of the MICE algorithm under different conditions of missingness and early stopping. For reasons of brevity, we only discuss results for the worst-performing estimates in terms of bias. For univariate scientific estimands ($Q=\mu$ and $Q=\sigma$) we observe the largest bias in the outcome variable $Y$. And for the regression coefficients ($Q=\beta$) the bias is most pronounced in $\beta_1$ (the effect of $X_1$ on $Y$). Since there is just one estimate for $Q=r^2$ to evaluate, we consider $Q=\mu_Y, \sigma_Y,r^2, \beta_1$. In the figures, we present all missingness conditions, but only early stopping conditions where $1 \leq T\leq50$. That is, the results are more or less stable for conditions where $T \geq 30$. Full results are available from [github.com/hanneoberman/MissingThePoint](https://github.com/hanneoberman/MissingThePoint).

## Quantities of scientific interest

```{r Qs, fig.height = 6.8, fig.cap="Impact of non-convergence on statistical inferences. Depicted are the bias, coverage rate (CR) and confidence interval width (CIW) of the estimates $\\bar{Q}$. We present the subset of $Q$s with the worst performance in terms of bias: the mean and standard deviation of $Y$, and the regression coefficient of $X_1$."}
mean_bias + sd_bias + Rsq_bias + est_bias + est_cov + est_ciw + plot_layout(ncol = 2, guides = "collect") + plot_annotation(tag_levels = "A", tag_suffix = ".")
```


Figure \ref{fig:Qs} displays the influence of missingness and early stopping on the estimated quantities of scientific interest, $Q$s. In the first row of the figure, we see the bias in the estimated descriptive statistics ($Q=\mu_Y$ and $Q=\sigma_Y$; panels A and B). The second row shows the bias in the multivariate scientific estimands ($Q=r^2$ and $Q=\beta_1$; C and D). The third row consists of the coverage rate (CR) and confidence interval width (CIW) of the estimated regression coefficient ($Q=\beta_1$; E and F). 

<!-- Simulation conditions that are impacted by non-convergence portray more extreme bias in the estimated $Q$s, and non-nominal coverages.  -->


### $Q=\mu$.
The estimated univariate means seem unaffected by early stopping. This implies that approximately unbiased estimates may be obtained with as little as one iteration ($T \geq 1$). The bias in $\bar{Q}$ depends solely on the proportion of incomplete cases, with $p_{\rm inc}\geq.75$ leading to more extreme biases than other conditions. Completely unbiased estimates are only obtained in conditions where $p_{\rm inc}\leq.50$. This is curious since the MCAR missingness mechanism should yield unbiased univariate estimates without employing multiple imputation. Note however, that the magnitude of the bias in these conditions is small: $\mu_Y$ is maximally under-estimated by 0.02 units, while the true value of $\mu_Y$ is 25.81 ($\sigma_Y = 11.32$). We, therefore, conclude that non-convergence does not substantially impact the validity of the inferences for $Q=\mu$. 

### $Q=\sigma$.
The estimated standard deviations are not substantially impacted by early stopping either. While the estimates for $T=1$ are not equal to other conditions, the bias is actually *less* severe than for $T\geq2$. Therefore, no iteration at all is needed to obtain approximately unbiased estimates for $Q=\sigma$. Completely unbiased estimates are only obtained in conditions where $p_{\rm inc}=.05$. The other missingness conditions are impacted by non-convergence in the order of increasing $p_{\rm inc}$. Similar to $Q=\mu$, the magnitude of the bias in $Q=\sigma$ is negligible. We, therefore, conclude that neither one of the univariate $Q$s is affected substantially by non-convergence.
<!-- in the first iteration. how impact of non-convergence similar to the means. The magnitude of the bias $\bar{Q}$ follows the incremental order of the missingness proportions. The number of iterations in the algorithm has little effect on the bias. Only the estimates in simulation conditions with just one iteration ($T=1$) differ from other conditions that have the same missingness proportion but a higher number of iterations. Interestingly, the bias in conditions where $T=1$ is *less* severe than after continued iteration. For the least possible bias, we may use any number of iterations $T\geq1$, but only $p_{\rm inc} = 0.05$ results in completely unbiased $\bar{Q}$s. -->

### $Q=r^2$.
In contrast to the univariate estimates, the estimated coefficient of determination is clearly affected by early stopping, see Figure \ref{fig:Qs}C. The bias in $Q$ appears to decrease with each additional iteration, while the magnitude of the bias still depends on the proportion of incomplete cases. Therefore, we see that the number of iterations that is necessary to reach stable, non-improving estimates also differs across missingness conditions. In conditions where $p_{\rm inc}=.05$, estimates are unbiased after one iteration. The highest number of iterations necessary to reach approximate unbiasedness is seven ($p_{\rm inc}=.95$; $T\geq7$). Completely unbiased estimates are only obtained in conditions where $p_{\rm inc}\leq.25$. This implies that even for biased estimates, $T\geq7$ would suffice to reach a stable solution.



<!-- portion is at most 25%. Approximately unbiased estimates are observed for any missingness proportion. For $p_{\rm inc}\leq.25$, the minimum number of iterations is two ($T\geq2$),  for $p_{\rm inc}=.50$ it is $T\geq4$, and $p_{\rm inc}=.75$ requires $T\geq5$. The highest number of iterations needed to obtain valid inferences is seven ($p_{\rm inc}=.95$; $T\geq7$).  while the best performance occurs with less missingness and more iterations. Only conditions with the lowest missingness proportion ($p_{\rm inc}=0.05$) results in unbiased estimates for every number of iterations. In other conditions there is at least some bias irrespective of $T$. The inferences do not improve in any condition where $T \geq 6$. This suggests that the algorithm is as converged as necessary to obtain valid inferences. -->

### $Q=\beta$.
For the estimated regression coefficients, we first consider bias, before discussing CR and CIW. As Figure \ref{fig:Qs}D shows, the bias in $\bar{Q}$ is affected by both the proportion of incomplete cases and the number of iterations. Similar to $Q=r^2$, we observe approximately unbiased estimates after at least one, and at most seven iterations, depending on $p_{\rm inc}$. Completely unbiased estimates are only obtained in conditions where $T\geq3$ and $p_{\rm inc}\leq .50$. Despite persistent bias in conditions where $p_{\rm inc}\geq.75$, the coverage rates are non-improving after just three iterations, irrespective of $p_{\rm inc}$. We conclude that any condition where $T\geq3$ yields approximately nominal coverage rates, and thus confidence-valid estimates.
<!-- , whereas we need $T\geq7$ to reach approximate unbiasedness. -->
The nominal coverages can be explained by the CIWs. The CIWs depicted in Figure \ref{fig:Qs}F are conform the theoretical foundation of MI: CIs are wider in conditions with higher proportions of incomplete cases (i.e., there is less information in the data, and thus more uncertainty due to missingness). Since conditions with higher $p_{\rm inc}$ result in both wider CIs and more severe bias, the true value of $Q$ may be included in the CI, despite of the bias in $\bar{Q}$.
<!-- around $\bar{Q}$ in conditions with higher missingness proportions **results in the inclusion of** the true value of $Q$ despite of bias. -->
We conclude that approximately unbiased estimates may be obtained in conditions where $T\geq7$, whereas confidence-valid estimates require at most three iterations. 

<!-- confidence interval width (CIW), and coverage rate (CR) as performance measures. **[Split panels]** Unbiased estimates are obtained in conditions where $p_{\rm inc}\leq.50$ and $T\geq3$. Approximately confidence-valid estimates are obtained in any condition where $T\geq3$---despite of persistent bias in conditions where $p_{\rm inc}\geq.75$. These approximately nominal coverages are explained by the CIWs: as expected, conditions with higher missingness proportions result in more uncertainty in the estimates (i.e., wider CIs), which diminish the effect of the bias. confidence-valid inferences may be obtained when $T\geq3$, while we need at least seven iterations to reach valid inferences in terms of bias. Continued iteration after $T\geq7$ seems futile. **[add max T for other betas?]** -->
<!-- One exception is the CIW of the most extreme condition ($p_{\rm inc}=.95$; $T=1$). -->



### Summary. 
These results demonstrate that the estimates of univariate scientific estimands $Q$ are not impacted by early stopping of the MICE algorithm or the proportion of incomplete cases in $y$. Unbiased estimates may be obtained after just one iteration. Multivariate estimates, by contrast, are affected by both the number of iterations and the proportion of missing cases. Completely unbiased estimates are only obtained under low to moderate missingness ($p_{\rm inc}\leq.50$), after at most three iterations. We observe approximately unbiased estimates after at most seven iterations (for any $p_{\rm inc}$ considered). This implies that the algorithm produces stable, non-improving estimates when $T\geq7$. 

<!-- Overall, we see that conditions with a higher proportion of missingness are affected more severely by non-convergence. Multivariate $Q$s are also substantially influenced by the number of iterations. This means that the algorithm has indeed not converged at $t=1$, and converges gradually as $t$ moves to $T$. The point at which an additional iteration does not lead to an improvement in the estimates depends on quantity of scientific interest $Q$ and the missingness proportion $p_{\rm inc}$. The highest number of iterations that is necessary to reach this point across all simulation conditions is $T=7$. This implies that, under the current specifications, no more than seven iterations are necessary to obtain sufficient performance in terms of bias and confidence-validity.  -->

<!-- Conditions with a lower number of iterations yield more bias in $\bar{Q}$. This is especially pronounced in conditions with high missingness proportions: with 95% missingness we need at least seven iterations before an additional iteration does not lead to improved estimates. Conditions with a lower missingness proportion (e.g., $p_{\rm inc} = {0.5}$), produce *optimal* estimates with as many as two iterations. Approximately unbiased estimates are obtained for all conditions where $p_{\rm inc}\leq0.75$ and $T\leq6$. **[Add CIW and CR]** -->

<!-- The sign of the bias is logical: when there is less info in the data, the relations between the predictors and the outcome is under-estimated. -->


## Non-convergence diagnostics

Figure \ref{fig:rhats-acs} displays results of the eight sets of diagnostic methods. The two columns in the figure represent the  non-convergence diagnostics $\widehat{R}$ and $AC$; the rows depict the four scalar summaries $\theta$ under consideration. The first row in Figure \ref{fig:rhats-acs} thus shows $\widehat{R}$ and $AC$ applied on the chain means (panels A and B). In the second row, we see the diagnostics applied on the chain variances (C and D). The third row depicts the same for $\theta=\hat{Q}$ (E and F). And in the last row, we see the diagnostics applied on the novel $\theta$ to consider: $\lambda_1$ (G and H). We evaluate the performance of the methods by establishing whether they correctly identify conditions in which $\bar{Q}$ is *not* an unbiased, confidence-valid estimate of $Q$. As we concluded in the last section, substantially biased estimates were only obtained in conditions where $T\leq6$, and we observed non-nominal coverage only when $T\leq3$. However, there was some persistent bias in conditions where $p_{\rm inc}\geq.75$, irrespective of the number of iterations. If the diagnostic methods are appropriate for MI, we will detect non-convergence in these conditions.

<!-- are appropriate,  **[appropriate methods thus identify these conditions]** -->

<!-- We evaluate the non-convergence diagnostics $\widehat{R}$ and $AC$ against the performance measures described above (i.e., bias and confidence-validity of the quantities of scientific interest $Q$). The diagnostics should identify those simulation conditions that are negatively impacted by non-convergence. We expect the most signs of non-convergence in conditions where valid estimates are not obtained (high missingness proportions, $T<7$), and at least some signs of non-convergence in conditions where estimates are not approximately unbiased ($p_{\rm inc}=.95$, any number of iterations).  -->

<!-- As we have observed, the affected conditions are $p_{\rm inc}=.95$ for all all $Q$s are impacted by the missingness proportions, but only the multivariate quantities of scientific interest are affected by the number of iterations.  -->

<!-- Figure \ref{fig:rhats-acs} displays the non-convergence diagnostics $\widehat{R}$ and $AC$ for each of the four $\theta$s under consideration. **[Add panel labels and explain how to read the plots]**  -->

```{r rhats-acs, fig.height = 6.8, fig.cap="Non-convergence diagnostics $\\widehat{R}$ and $AC$ applied on several $\\theta$s. The left-hand side of the figure contains $\\widehat{R}$-values, and the right-hand side contains $AC$-values. Depicted in the rows are the scalar summaries $\\theta$: chain mean, chain variance, the quantity of scientific interest $\\hat{Q}$, and the first eigenvalue of the variance-covariance matrix $\\lambda_1$."}
mean_Rh + mean_AC + var_Rh + var_AC + est_Rh + est_AC + PCA_Rh + PCA_AC + plot_layout(guides = "collect", ncol = 2) + plot_annotation(tag_levels = "A", tag_suffix = ".")
```

<!-- **Message: after one iteration ($T$=2), the algorithm is as well converged as the missingness proportion allows. Sooner even with lower missingness proportions---$T$=1 might be sufficient for $p_{\rm inc}$ = 5, 25, and 50.** Number of iterations has little influence on bias in $\hat{Q}_\ell$, only in first iteration there is some bias in missingness conditions of 25 and up. There is a clear different between the missingness conditions. The higher the missingness prop, the larger the magnitude of the bias. For this $Q$, t=2 would be sufficient. And only for $p_{\rm inc}$ = 5 the $\bar{Q}$s are unbiased. All other $p_{\rm inc}$ conditions have bias irrespective of the number of iterations. -->

### $\theta=$ chain mean. 
As expected, $\widehat{R}$ lowers with the number of iterations. After an initial 'dip' in conditions where $T=3$, we observe a gradual decrease in $\widehat{R}$-values with every additional iteration. This implies improving convergence, until the decrease tapers off after 30 to 40 iterations. Using the threshold $\widehat{R}>1.2$, we diagnose non-convergence in conditions where $T\leq7$, whereas the threshold 1.1 is exceeded when $T\leq13$. The very strict threshold 1.01 is surpassed in all conditions $T\leq100$ (not shown), and therefore not informative under the current specifications. With this set of methods, we fail to identify simulation conditions with persistent bias due to high missingness proportions.

Similarly, $AC$ decreases with higher $T$s. $AC$ indicates improving stationarity in conditions where $T\leq6$. The $AC$-values do not exceed the threshold defined by statistical significance of the $AC$-values. Based on this threshold, we fail to diagnose non-convergence in any condition.  


<!-- We evaluate the performance of the non-convergence diagnostics applied to chain means against the bias in $Q=\mu$. Based on the bias in $Q$, we concluded that one iteration is sufficient to obtain valid inferences, irrespective of the missingness proportion. The non-convergence diagnostics, however, identify some signs of non-convergence in conditions with as many as thirty iterations. This does not correspond to the impact of non-convergence in the univariate $Q$s. **Compared to the multivariate $Q$s [add before that we evaluate the thetas against all Qs?], $\widehat{R}$ and $AC$ applied to the chain means fail to identify the non-convergence in conditions where $p_{\rm inc}=.95$.**  -->

```{r mean, fig.height = 6.8, fig.cap="Convergence diagnostics chain mean."}
# mean_bias + mean_Rh + mean_AC + plot_layout(guides = "collect", ncol = 1) + plot_annotation(tag_levels = "A", tag_suffix = ".", title = bquote("Q = " ~ mu[Y] ~ "= 25.81; " ~ theta ~ "= chain mean of Y in" ~ y[imp][",m"])) #& theme(legend.position = "bottom")
```


### $\theta=$ chain variance.
As panel C and D in Figure \ref{fig:rhats-acs} show, the results of this set of methods are highly similar to those with chain means as $\theta$. This holds for both $\widehat{R}$ and $AC$. The only apparent difference is in the $\widehat{R}$ threshold 1.1. Instead of diagnosing non-convergence in conditions where $T\leq13$, we now diagnose this when $T\leq11$. All other observations are equivalent.

<!-- We thus conclude that there is no added value of evaluating non-convergence with chain variances as $\theta$ in the diagnostics. -->


```{r sd, fig.height = 6.8, fig.cap="Convergence diagnostics chain variance."}
# sd_bias + var_Rh + var_AC + plot_layout(guides = "collect", ncol = 1) + plot_annotation(tag_levels = "A", tag_suffix = ".", title = bquote("Q = " ~ sigma[Y] ~ "= 11.32; " ~ theta ~ "= chain variance of Y in" ~ y[imp][",m"]))
```

### $\theta=\hat{Q}$.
The $\widehat{R}$-values in Figure \ref{fig:rhats-acs}E show a similar trend across iterations as we observed for chain means and chain variances. Only conditions with very high missingness proportions ($p_{\rm inc}\geq.75$) diverge from the earlier observations. The $\widehat{R}$-values in these conditions do not taper off after 30 to 40 iterations, but rather between 40 to 50 iterations. The highest number of iterations at which non-convergence is still diagnosed according to the thresholds are 11 for $\widehat{R}>1.2$, 23 for $\widehat{R}>1.1$, and 100 for $\widehat{R}>1.01$ (not shown). 

The $AC$-values also follow earlier observations, with the same exception as for $\widehat{R}$ (when $p_{\rm inc}\geq.75$). To reach maximum stationarity, these conditions require at most seven iterations instead of five. Moreover, the $AC$-values in these conditions exceed the threshold to diagnose non-convergence. Interestingly, this only occurs after ten or even thirty iterations, while we would expect more signs of trending early in the iterations. Since the $AC$-values are not improving or worsening when $T\geq7$, we conclude that non-convergence is incorrectly diagnosed based on the threshold.


<!-- The non-convergence diagnostics are applied to the estimated regression coefficients in each imputation, and evaluated against the bias in the corresponding pooled estimate.  -->

<!-- $\widehat{R}$ indicates signs of non-convergence across all missingness proportions and each number of iterations, in the expected order: simulation conditions with higher missingness proportions and less iterations are identified as the worst converged. The thresholds to diagnose non-convergence are overcome in different conditions, depending on the number of iterations and the missingness proportion. The most lenient threshold ($\widehat{R}>1.2$) is overcome at $T\geq9$ for $p_{\rm inc} = 0.05$, and $T\geq12$ for $p_{\rm inc} = 0.95$. The conventional $\widehat{R}>1.1$ is surpassed at $T\geq12$ and $T\geq24$, respectively. -->

<!-- For the autocorrelations applied to the $\hat{Q}_\ell$s, we see an even stronger effect of the missingness proportions. Especially the conditions where $p_{\rm inc} = 0.75$ and $p_{\rm inc} = 0.95$ are identified as non-stationary. The threshold used to evaluate whether $AC=0$, however, is only reached in conditions with at least ten iterations. This suggests that the default number of iterations may be too low to detect non-stationarity with $AC$. However, the critical value for diagnosing non-convergence with $AC$ decreases as a function of the number of iterations. The conclusion to identify non-stationarity in conditions where $T\geq10$ and $p_{\rm inc} = 0.95$ might therefore be spurious.  -->

<!-- **[Also, the $AC$ across missingness proportions shows the opposite of what you would expect: shouldn't there be higher autocorrelations in conditions with comparatively more observed data in the completed datasets? I don't understand this.]** -->

<!-- Compared to the bias in $\bar{Q}$, the diagnostics applied to the $\hat{Q}_\ell$s over-estimate the severity of the non-convergence.  -->


### $\theta=\lambda_{1}$.
Once again, we observe $\widehat{R}$-values with a similar trend across iterations. For this $\theta$, the results differ only in the most extreme missingness condition. When $p_{\rm inc}=.95$, we diagnose non-convergence at $T\leq9$ according to $\widehat{R}>1.2$, $T\leq19$ for $\widehat{R}>1.1$, and 100 for $\widehat{R}>1.01$ (not shown). The 'dip' in $\widehat{R}$-values at $T=3$ is even more pronounced than with other $\theta$s. Some $\widehat{R}$-values even overcome the threshold of 1.2. If we would terminate the algorithm at $T=3$, we would incorrectly conclude that the algorithm reached approximate convergence, according to this threshold.

$AC$-values are systematically higher for this $\theta$ than for other scalar summaries. The $AC$-values also taper off at a later point in the iterations. This suggests improving stationarity up-to ten, or even thirty iterations, depending on the missingness proportion. Using the threshold, we diagnose non-convergence at some point in all missingness conditions. However, this occurs only after reasonably decreasing $AC$-values are obtained---again suggesting that non-convergence is incorrectly diagnosed.   

<!-- And especially in conditions with higher missingness proportions, we observe signs of increasing stationarity the decrease in the $AC$-values across iterations is also  -->


<!-- Finally, we evaluate the non-convergence diagnostics applied to the first eigenvalue of the variance-covariance matrices of the completed data. Similar to the results the the regression coefficients as $\theta$s, we see effects of both the missingness proportion and number of iterations in each simulation condition. The most signs of non-convergence are identified in conditions where $p_{\rm inc}$ is large and $T$ is small. -->

<!-- Notwithstanding the similarities with $\theta=\hat{Q}_\ell$, there is a big difference in $\widehat{R}$-values for conditions where $T<4$. In these conditions, $\widehat{R}$ behaves oppositely of our expectation: conditions with the lowest missingness proportions yield the highest $\widehat{R}$-values. In conditions with a higher number of iterations, this artifact disappears. This suggests that the combination of $\widehat{R}$ and $\lambda_{1, \ell}$ is only appropriate for imputation algorithms where the number of iterations at least four. Interpreting the $\widehat{R}$-values of conditions where $T<3$ may lead to the incorrect conclusion that only conditions with *low* missingness proportions show signs of non-convergence. For applications as a model-independent multivariate $\theta$, we should therefore only interpret the $\widehat{R}$-values when $T\geq4$. Using this cut-off we conveniently ignore the initial 'dip' at $T=3$ as well. The traditional threshold $\widehat{R} > 1.2$ is overcome in conditions where $p_{\rm inc} = .95$ and $T\geq10$, and for all other missingness proportions in conditions where $T\geq8$. With the $\widehat{R} > 1.1$ threshold, the number of iterations are $T\geq20$ and $T\geq16$, respectively. -->

<!-- The $AC$-values largely depend on the missingness proportion in each condition. Conditions where $p_{\rm inc}=.95$ show statistically significant autocorrelations for any number of iterations. The other extreme, conditions where $p_{\rm inc}=.05$, does not yield $AC$-values above the threshold. The $AC$-values with this missingness proportion are equivalent for all conditions where $T\geq6$, which suggests that the algorithm is as stationary as it can be. A similar point is only observed after twenty iterations in conditions with higher missingness proportions.  -->

<!-- In comparison to the $Q$s, the diagnostics again over-estimate the signs of non-convergence. Conditions with low missingness proportions (e.g., 5% or 25% of the complete data) yield unbiased, confidence-valid estimates with as little as two iterations. The convergence diagnostics, however, indicate improved convergence up-to eight iterations according to $AC$ and thirty to forty iterations according to $\widehat{R}$. The model-independent $\theta$ $\lambda_{1, \ell}$ seems as well-equipped to diagnose signs of non-convergence as $\theta=\hat{Q}_\ell$. The univariate $\theta$s do not differentiate between bias induced by the missingness proportions.   -->



### Summary. 
Overall, the methods to diagnose non-convergence perform as expected: they indicate more signs of non-convergence in conditions with worse performance in terms of bias and confidence-validity. Under low to moderate missingness, it does not seem to matter on which $\theta$ the non-convergence diagnostics are applied. If we look at complete unbiasedness, however, we notice that univariate $\theta$s fail to diagnose the persistent bias in conditions where $p_{\rm inc}\geq.75$. 

The number of iterations necessary to obtain approximately unbiased, confidence-valid estimates corresponds to the $\widehat{R}$ threshold 1.2. The thresholds 1.1 and 1.01 seem too strict compared to the validity of the inferences. The threshold to diagnose significant $AC$-values does not appear to be appropriate in at least the current set-up, and perhaps in iterative imputation in general. A better heuristic to diagnose non-stationarity with $AC$ may be through evaluation of the $AC$-values across iterations: If the values do not substantially decrease with $T$, approximate stationarity may be concluded.
<!-- **[similar to the elbow heuristic in PCA]**. -->




<!-- In general, the diagnostics identify more signs of non-convergence in simulation conditions with a lower number of iterations. The missingness proportions, however, only seem to impact multivariate convergence. When $\widehat{R}$ and $AC$ are applied to  univariate $\theta$s, they identify the same amount of non-convergence for any missingness proportion. When the diagnostics are applied to multivariate $\theta$s, they generally identify more signs of non-convergence for higher missingness proportions.  -->

<!-- As expected, none of the simulation conditions that we consider resulted in complete convergence of the algorithm (defined as $\widehat{R}=1$ and $AC=0$). However, the thresholds used in practice to diagnose non-convergence seem too conservative for imputation purposes. $\widehat{R}$ and $AC$ identify signs of non-convergence in conditions where the $\bar{Q}$s are unbiased and confidence-valid estimates of the $Q$s. The most recent recommended threshold for diagnosing non-convergence with $\widehat{R}$ is never overcome in this study (all $\widehat{R}$>1.01). Apparently, this threshold is too stringent for iterative imputation algorithms, and will not be discussed any further. -->

<!-- This is odd, since the $\theta$ and $Q$ are directly related.   -->


```{r est, fig.height = 6.8, fig.cap="Convergence diagnostics regression coefficient."}
# est_bias + est_Rh + est_AC + plot_layout(guides = "collect", ncol = 1) + plot_annotation(tag_levels = "A", tag_suffix = ".", title = bquote("Q = " ~ beta[1] ~ "= 2.06; " ~ theta ~ "= " ~ hat(Q) ~ "in {" ~ y[obs] ~ "," ~ y[imp][",m"] ~ "}"))
```

```{r pred, fig.height = 6.8, fig.cap="Convergence diagnostics regression coefficient."}
# Rsq_bias + PCA_Rh + PCA_AC + plot_layout(guides = "collect", ncol = 1) + plot_annotation(tag_levels = "A", tag_suffix = ".", title = bquote("Q = " ~ r^2 ~ "\u00D7 100 = 19.25; " ~ theta ~ "= " ~ lambda[1] ~ "in {" ~ y[obs] ~ "," ~ y[imp][",m"] ~ "}")) #first eigenvalue of" ~ Sigma ~ 
```

<!-- ## Univariate estimates and convergence diagnostics  -->

<!-- The bias in the estimates of the variable means shows little to no difference between simulation conditions. It doesn't seem to matter how many iterations you use in the mice algorithm, the estimates are unbiased. Similarly, the bias in the estimated variances is more or less stable across simulation conditions. These univariate quantities appear to be unaffected by the number of iterations. -->

<!-- When applied to the imputation chain means, $\widehat{R}$ indicates that the mice algorithm does not reach a converged state ($\widehat{R}$ = 1) in any of the simulation conditions. Neither is the most recent recommended threshold reached ($\widehat{R}$ < 1.01). **This is only for 75% missingness:** The conventional $\widehat{R}$ threshold of 1.2 is reached in simulation conditions $T = 3$ and $T > 6$. (With the default number of iterations (maxit = 5), this dip in $\widehat{R}$-values would be spotted, so it is no problem.) The point at which an extra iteration does not seem to improve the $\widehat{R}$ value is around $T=30$. -->

<!-- Autocorrelations indicate no sign of trending **(NOT correct anymore, fluke of the stats::acf() function!!)** within imputation chains. In most simulation conditions $AC$ is smaller than or about equal to zero. Across simulation conditions, however, the autocorrelation curve does not trend towards 0. Autocorrelation values plateau off at a value of around.1. This is a small positive autocorrelation, which would indicate some trending within chains. -->

<!-- The $\widehat{R}$ and $AC$-values for the imputation chain variances show equal trends to the chain means and are therefore not discussed separately. Taken together, univariate estimates seem robust across simulation conditions. There is no clear effect of the number of iterations on the bias in these estimates, while the convergence diagnostics indicate that the algorithm did not reach a completely converged state (yet). -->


<!-- ## Multivariate estimates  -->

<!-- **This is only true for 75% missingness:** There is a clear bias in the regression estimates in simulation conditions where the number of iterations is smaller than four. In simulation conditions where $T > 5$ there is little to no bias in the estimated regression coefficients. In most simulation conditions nominal coverage is obtained (i.e., coverage rates of.95) for the confidence intervals around the regression coefficients. Conditions with only one or two iterations show some under-coverage. Since confidence interval width is stable across conditions, the under-coverage may be attributed to the bias in the estimated regression coefficients. -->

<!-- **This is only true for 75% missingness:** If we look at the estimated proportion of explained variance in outcome variable Y we see that the coefficient of determination is underestimate estimated in conditions where the number of iterations is equal to two or less, and slightly overestimated in conditions where the number of iterations is equal to three or more.  -->


```{r thresh-Rh, include=FALSE}
# # chain means
# dat[-1, 6:9] %>% mutate(max_Rh = apply(., 1, max)) %>%.$max_Rh<1.2
# 
# # chain variances
# dat[-1, 26:29] %>% mutate(max_Rh = apply(., 1, max)) %>%.$max_Rh<1.2

# qnorm((1 + .95) / 2) / sqrt(t)


```

# Discussion

Before drawing any further conclusions, let us first return to the hypotheses that we formulated for the simulation study. 

1. As hypothesized, biased, invalid estimates of quantities of scientific interest occurred more often in simulation conditions with a high proportion of incomplete cases $p_{\rm inc}$ and a low number of iterations $T$. However, this only holds for multivariate scientific estimands. Univariate $Q$s are not substantially impacted by early stopping.

2. Our results also support the hypothesis that $\widehat{R}$ and $AC$ would correctly identify signs of non-convergence. We observed higher $\widehat{R}$ and $AC$-values in conditions where $\bar{Q}$s were biased, invalid estimates of $Q$s. 

3. We hypothesized that the recommended thresholds to diagnose non-convergence with $\widehat{R}$ would be too stringent for iterative imputation applications. This hypothesis is only partially supported. $\widehat{R}$ indicated improving convergence until 30 to 40 iterations, while approximately unbiased, confidence-valid estimates were obtained after just seven iterations. This roughly corresponds to the threshold of 1.2. The more stringent threshold 1.1 seems plausible compared to the decrease in $\widehat{R}$-values across iterations. The most recent threshold 1.01 does indeed seem to over-estimate the signs of non-convergence.

4. The results of this simulation study do not support the hypothesis that high $AC$-values are implausible in iterative imputation algorithms with typical convergence. We expected that the randomness induced by the algorithm would effectively mitigate the risk of dependency within chains after a few iterations. In this study, however, we observed $AC$-values as high as theoretically possible ($AC=1$). The second part of the hypothesis is not refuted: the $AC$-values did decrease quickly as a function of $T$.

5. Our final hypothesis was that multivariate $\theta$s would be better at detecting non-convergence than univariate $\theta$s. Multivariate $\theta$s did indeed show superior performance under certain conditions (e.g., multivariate $Q$s and extreme missingness proportions).



## Conclusion

We have shown that non-convergence in iterative imputation algorithms goes hand in hand with biased, invalid estimates---at least for the multivariate quantities of scientific interest considered in this study. Identifying non-convergence may be a crucial aspect of drawing valid statistical inferences from incomplete data. We concluded that the current practice of visually inspecting non-convergence through traceplots of univariate scalar summaries of the state-space of the algorithm does not suffice. We, therefore, considered eight sets of diagnostic methods to identify non-convergence: two non-convergence diagnostics ($\widehat{R}$ and $AC$), two univariate $\theta$s, a model-dependent multivariate $\theta$, and a novel, model-independent multivariate $\theta$. Signs of non-convergence due to early stopping were identified with each of the methods. Bias due to high proportions of incomplete cases was only identified with multivariate $\theta$s. 

Since we obtained approximately unbiased, confidence-valid estimates after at most seven iterations, we conclude that the $\widehat{R}$ threshold 1.2 is the most appropriate diagnostic cut-off. The threshold to diagnose non-stationarity with $AC$ does not seem to apply. However, some signs of non-convergence were detected in simulation conditions many more iterations. Under moderate missingness ($p_{\rm inc}\leq.50$) $\widehat{R}$-values decreased substantially until 30 to 40 iterations, which implies that mixing in the algorithm still improved with each additional iteration. $AC$-values only improved until about six iterations, suggesting minimal improvement in trending was obtained beyond $T=6$ in the current simulation set-up. 

The main finding of this study is that valid inferences may be obtained much quicker than approximate algorithmic convergence is reached. Under the current specifications, univariate $Q$s did not require algorithmic convergence at all. They are unbiased almost instantly after the algorithm is initiated. Approximately unbiased, confidence-valid estimates of multivariate $Q$s were obtained after a maximum of seven iterations. Continued iterations beyond $T = 7$ did not yield better estimates.


## Implications

Iterative imputation algorithms such as MICE are known to yield valid results under severe missingness. With this study, we have shown that valid inferences can also be obtained under a combination of severe missingness and early stopping. Based on our results, the traditional threshold of $\widehat{R}> 1.2$ would be appropriate for diagnosing non-convergence in iterative imputation algorithms. This is, however, not in line with the recent recommendations by @veht19 to lower the threshold to 1.01. The discrepancy between our conclusion and Vehtari et al. may be explained by the nature of iterative imputation algorithms. In the limit, iterative imputation algorithms have the same characteristics as other MCMC algorithms. But, in imputation procedures, a part of the distribution is already determined by the observed data, whereas the entire distribution is unknown in many other MCMC applications. Since we combine a known distribution with an unknown distribution, valid estimates may be reached much sooner. Convergence may, therefore, be diagnosed at a less stringent threshold. 


The threshold to diagnose non-convergence with $AC$ does not seem appropriate at all in iterative imputation algorithms. A better diagnostic cut-off would be the number of iterations at which an additional iteration does not substantially decrease the $AC$-values. In practice, this implies that the default number of iterations in MICE is not sufficient. $AC$ can only be computed if $T\geq3$, while the current default in the `mice` package is five [@mice]. Identifying a reasonable decrease in the $AC$-values across iterations (an 'elbow') requires more than three observations. We, therefore, suggest to increase the default number of iterations in MICE to ten. The computational cost of five additional iterations has become less of a burden since MICE was introduced [-@mice]. Moreover, an increased number of iterations would grant the opportunity to exclude the first iterations from evaluation with $\widehat{R}$. Excluding $T\leq3$ provides empirical researchers with a less ambiguous heuristic to diagnose non-convergence, because we expect the initial 'dip' in $\widehat{R}$-values to disappear.

## Recommendations for empirical researchers

Based on our results, we formulate several recommendations for empirical researchers who employ iterative imputation to draw inferences from incomplete data. We suggest that non-convergence may still be evaluated visually, but in addition to inspecting univariate summaries of the state-space of the algorithm ($\theta$s, e.g., chain means), multivariate $\theta$s should be considered. We propose the following steps:

1. First, check traceplots of the default $\theta$s (e.g., chain means and chain variances) for signs of pathological non-convergence. Adjust the imputation model if necessary. 

2. Subsequently, decide which multivariate $\theta$s to track across iterations. The novel $\theta$ that we propose in this study, $\lambda_1$ is scientific model-independent and may thus always be employed. Alternatively, specify your own scalar summary of interest [see e.g., @buur18]. Monitor these $\theta$s through visual inspection, or using a non-convergence diagnostic.

3. Compute non-convergence diagnostics $\widehat{R}$ and $AC$. Do *not* use the original implementation to calculate $\widehat{R}$ [@gelm92], or the `R` function `stats::acf()` to compute $AC$ [@R]. Instead, calculate $\widehat{R}$ conform @veht19 and compute autocorrelations manually (see e.g., [github.com/hanneoberman/MissingThePoint](https://github.com/hanneoberman/MissingThePoint)). 

4. And finally, use the threshold $\widehat{R}>1.2$ to diagnose non-mixing, and assess stationarity by plotting the autocorrelation over iterations. Keep iterating until the threshold for mixing is overcome, and until reasonably decreasing asymptotic $AC$-values are obtained. At that point, inferences are unlikely to improve by continued iteration. 



## Limitations

Much remains unknown about non-convergence in iterative imputation algorithms. Even though we have demonstrated the appropriateness of $\widehat{R}$ and $AC$ as non-convergence diagnostics in this study, results may not extrapolate to other situations. In this study, we only considered the iterative imputation algorithm implemented in the `mice` package. The performance of the non-convergence diagnostics may depend on the characteristics of this specific algorithm. A potential threat to the ability to detect non-mixing with $\widehat{R}$, for example, is the assumption of over-dispersed initial states. In `mice`, the algorithm is initiated by sampling starting values at random from the observed data, whereas other imputation software may use the average of the observed cases. The latter could lead to a systematical under-estimation of the variability in the first few iterations and violate the assumption of over-dispersion. In those cases, it would be more difficult to detect non-convergence with $\widehat{R}$. Therefore, the diagnostic might not be  appropriate outside of `mice`. 

Moreover, the current simulation conditions were restricted to a single missingness mechanism. Proper performance under a 'missing completely at random' (MCAR) mechanism is a necessary condition for any missing data method. It does not, however, guarantee equal performance under different missingness mechanisms. Future research should determine the performance of $\widehat{R}$ and $AC$ under 'missing at random' and 'missing not at random' mechanisms. Another parameter to consider in future research is the choice of the imputation method. As @murr18 concluded, the behavior of algorithms such as MICE under certain default imputation models is still an open research question. We have investigated the behavior of MICE under only one type of model (Bayesian linear regression). Different imputations models might converge more poorly. 

The imputation model may even be mis-specified on purpose, to induce non-convergence of different severity levels. Qualitatively, we have shown that $\widehat{R}$ and $AC$ are appropriate under clear violation of convergence. Quantitatively, we have only demonstrated that they can identify signs of non-convergence under MCAR, when the imputation model is a correctly specified Bayesian linear regression model.  \newline \newline

<!-- **[ADD limitation that other MI packages may have different way to obtain initial values!]** -->

<!-- # Old discussion -->

<!-- We arrive back at the original questions that we posed. -->


<!-- - Non-convergence can be identified with non-convergence diagnostics $\widehat{R}$ and $AC$. But common thresholds are too conservative. Why? Part of the distribution is already determined by the observed data. in regular MCMC the entire distribution is unknown (**priors??**). In iterative imputation algorithms we have the same characteristics as MCMC in the limit, but because we combine the known distribution with the unknown distribution, convergence is reached much sooner. -->

<!-- - Inferences are unbiased much quicker than the algorithm has converged. All things univariate are converged almost instantly after initiating the iterative algorithm with a valid imputation model. But less quick with multivariate parameters.  -->

<!-- In short, iterative imputation algorithms may yield approximately unbiased, confidence-valid estimates under different levels of induced non-convergence. Univariate estimates seem robust against terminating the algorithm early: There is no clear effect of the number of iterations on the bias in estimated means and standard deviations. The bias in these $Q$s was only impacted by the missingness proportion $p_{\rm inc}$, with higher $p_{\rm inc}$ resulting in more bias. Bias in multivariate estimates depended on both $p_{\rm inc}$ and the number of iterations. However, the only effect of the number of iterations was observed when the algorithm was terminated at seven iterations or earlier. This suggests that continued iteration beyond seven iterations does not yield better estimates. Yet, the non-convergence diagnostics $\widehat{R}$ and $AC$ indicated that the iterative imputation algorithm did not reach a stable state before twenty to thirty iterations. **[MERGE or remove] $\widehat{R}$ and autocorrelation indicate that there are signs of non-convergence in the algorithm up-to at least twenty iterations, while unbiased, confidence-valid estimates may be obtained with as little as one iteration. This observation is in agreement with **one of [still add the others!]** the simulation hypotheses: $\widehat{R}$ over-estimates the severity of non-convergence when applied to MI procedures.**  -->

<!-- Over-estimation of the signs of non-convergence may be due to the methods (and their thresholds) or due to the $Q$s (descriptive and multivariate linear regression, not higher dimensional/more complex $Q$s). More complicated $Q$s (e.g., higher-order effects or variance components) might show bias, under- or over-coverage at higher $T$. Which might be why $\widehat{R}$ and $AC$ identify non-convergence.  -->



<!-- ```{r eval=FALSE, include=FALSE} -->
<!-- # **[INCLUDE this] The highest $\widehat{R}$-values are obtained for the condition $T=2$. We observe the same 'dip' in $\widehat{R}$ as we did in Figure \ref{fig:diagnostics} for conditions with three iterations. $\widehat{R}$ gradually decreases as the number of iterations increases across conditions. By the traditional threshold  $\widehat{R}>1.2$ we should conclude that there is non-convergence in conditions where $T<8$. The common threshold $\widehat{R}>1.1$ is overcome in conditions where $T>14$. ** -->
<!-- #    -->
<!-- #   **Autocorrelations indicate some signs of non-stationarity in all simulation conditions, but primarily in conditions where $T<6$. The threshold for diagnosing non-convergence is not reached in any condition. We would thus conclude that the algorithm is sufficiently converged regardless of the number of iterations or missingness proportion. ** -->
<!-- ``` -->



<!-- Some other interesting findings are **[REPHRASE]** -->

<!-- - Is there more bias in conditions where non-convergence was induced? (YES for multivar., NOPE for univariates). -->

<!-- - Is the point of *sufficient* convergence (at which the $\bar{Q}$s are unbiased and confidence-valid estimates of the $Q$s) the same point as identified by the non-convergence diagnostics? (NOPE, they are too conservative). -->

<!-- - Is one of the thetas better? (YES, while it doesn't really matter as long as it's multivariate, $\lambda_{1, \ell}$ is model-independent and therefore preferred). -->

<!-- - What should the thresholds be? (much HIGHER than recommended for $\widehat{R}$, difficult to say for $AC$).  -->

<!-- - And the default nr of iterations? (MAYBE increase to 10 to detect significant $AC$ and be sure not to miss the dip in $\widehat{R}$?). -->



<!-- As expected, complete convergence ($\widehat{R}=1$ and $AC=0$) is never observed. But what about the thresholds for practice? $\widehat{R}$ <1.2 is not stringent enough, because conditions in which $\widehat{R}$ is smaller than 1.2 do not all yield unbiased estimates of the $Q$s. Moreover, there is a dip in the $\widehat{R}$-values, after which $\widehat{R}$ > 1.2 again. If the algorithms would be terminated at the iteration where $\widehat{R}$ < 1.2 occurs for the first time, the increase in $\widehat{R}$-values might be missed. The threshold $\widehat{R}$ < 1.1 is somewhat conservative in comparison with the performance measures. Overall it seems OK. $\widehat{R}$ < 1.01 is too stringent compared to the performance measures. And it is not obtained for any number of iterations (**but may be necessary in more complex complete data models???**).  -->

<!-- According to this simulation study, the recently proposed threshold of $\widehat{R}<1.01$ may be too stringent for MI algorithms. Under the relatively easy missing data problem of the current study, the threshold was not reached. The other extreme of the $\widehat{R}$-thresholds, the conventionally acceptable $\widehat{R} <1.2$, may be too lenient for MI procedures. Applying this threshold to the current data, lead to falsely diagnosing convergence at $T = 3$ (**because it goes up after, not because it is not converged enough**). It appears that the widely used threshold of $\widehat{R} < 1.1$ suits MI algorithms the best. We might, however, also formulate a new threshold, specifically for the evaluation of MI algorithms. The current study suggests that $\widehat{R} < 1.05$ may be implemented, since that is the level at which the $\widehat{R}$ stabilize (around $T = 20$) (**Not necessary for this Q, but maybe for more complicated $Q$s**).  -->

<!-- The negative $AC$-values obtained in this study show no threat of non-stationarity. However, the initial dip in $AC$-values **(which disappeared!)** may have implications for the default number of iterations in `mice` (`maxit = 5`). Terminating the algorithm at $T=5$ may not be the most appropriate, since this lead to the worst convergence (**nope, only for Rh, not $AC$**), as indicated by $\widehat{R}$ and $AC$. Under the current specifications, $T>20$ would be more appropriate. -->





<!-- ## Recommendations for future research -->

<!-- Much remains unknown. about non-convergence in iterative imputation algorithms. Further research is needed to investigate the performance of iterative imputation algorithms under clear violation of convergence, e.g. dependency between predictors (predictors with very high correlations). For example: -->

<!-- - Induce non-convergence with mis-specified imputation model.  -->

<!-- - Introduce more difficult missingness problems, i.e., M(N)AR instead of MCAR. That is, proper performance under a 'missing completely at random' missingness mechanism is necessary to demonstrate the appropriateness of $\widehat{R}$ and $AC$ as non-convergence diagnostics. However, results may not be extrapolated to other missingness mechanisms.  -->

<!-- - Imputation technique with questionable convergence properties, e.g., PMM. -->

<!-- - Apply recommendations to empirical data and write a vignette for applied researchers. -->

<!-- - Implement recommendations in imputation software, e.g., evaluation environment for applied researchers. -->

<!-- - Develop an additional convergence diagnostic unique for iterative imputation: $AC$ across imputations, instead of iterations. -->


\noindent In short, we have shown that iterative imputation algorithms can yield correct outcomes, even when a converged state has not yet formally been reached. Any further iterations would then burn computational resources without improving the statistical inferences. Our study found that---in the cases considered---inferential validity was achieved after five to ten iterations, much earlier than indicated by the $\widehat{R}$ and AC diagnostics. Of course, it never hurts to iterate longer, but such calculations hardly bring added value.

<!-- # Grading -->

<!-- - Scientific contribution  -->
<!-- (clear research question, convincing argumentation that the study adds to the scientific literature) -->

<!-- - Theory -->
<!-- (use of theory, clear hypotheses, relevant literature) -->

<!-- - Method -->
<!-- (correct data collection/handling, measures, choice and description of method of analysis) -->

<!-- - Results -->
<!-- (correct interpretation of findings, clear presentation) -->

<!-- - Discussion and conclusions -->
<!-- (summary, broader implications, limitations, future research) -->

<!-- - Written presentation -->
<!-- (writing, structure, tables and figures, references) -->

<!-- # References -->
